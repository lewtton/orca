{"version":3,"sources":["index.js"],"names":["cardclass","cardnum","players_num","Card","className","this","props","onClick","value","React","Component","Cardy","Gzone","state","players","userid","holdid","cardvalue","cardcur","isSel","Array","fill","intervalId","setInterval","syncData","siri","cache","shift","push","setState","initData","uid","_this","formdata","FormData","append","axios","method","url","data","then","response","result","lens","i","cards","hold","cur","catch","error","console","log","n","s","slice","card","num","len","length","toSuit","slicy","document","getElementById","innerHTML","children","c","cclass","cnum","Math","floor","key","btn_card","btn_start","class","id","sort","btn_setnum","btn_call","btn_next","btn_turn","map","renderZone","btn_update","btn_recall","renderMantainer","renderHold","renderYard","renderCard","ReactDOM","render"],"mappings":"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","file":"static/js/main.235bc235.chunk.js","sourcesContent":["import React, { Fragment } from 'react';\nimport ReactDOM from 'react-dom';\nimport axios from 'axios';\nimport './index.css';\nconst cardclass = [\"card suitspades\", \"card suithearts\", \"card suitclubs\", \"card suitdiamonds\", \"card\", \"cardsel suitspades\", \"cardsel suithearts\", \"cardsel suitclubs\", \"cardsel suitdiamonds\", \"cardsel\"];\nconst cardnum = [\"A\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"J\", \"Q\", \"K\", \"小\", \"大\", \"胜\", \"败\"];\nvar players_num = 4;\nclass Card extends React.Component {\n  render() {\n    return (\n      <div className={this.props.className} onClick={() => this.props.onClick()}>\n        <p>{cardnum[this.props.value]}</p>\n      </div>\n    )\n  }\n}\nclass Cardy extends React.Component {\n  render() {\n    return (\n      <div className={this.props.className} >\n        <p>{cardnum[this.props.value]}</p>\n      </div>\n    )\n  }\n}\n\nclass Gzone extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      players: [\"东\", \"北\", \"西\", \"南\"],\n      userid: 0,\n      holdid: 1,\n      cardvalue: [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1,1,1,1,1,1], [2,2,2,2,2,2,2], [3,3,3,3,3,3,3,3]],\n      cardcur: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n      isSel: Array(16).fill(false),\n    };\n    this.intervalId = setInterval(() => {\n      this.syncData();\n    }, 200);\n\n  }\n  syncTest() {\n    var siri = this.state.cardvalue;\n    var cache = siri.shift();\n    siri.push(cache);\n    this.setState({\n      cardvalue: siri,\n\n    })\n  }\n\n  componentWillMount() {\n    this.initData(99);\n  }\n  serialize(uid) {\n\n    \n  }\n\n  syncData() {\n    const _this = this;\n    let formdata = new FormData();\n    formdata.append(\"sync\", 1);\n    axios({\n      method: 'post',\n      url: 'apipk/',\n      data: formdata,\n    })\n      .then(function (response) {\n        var result = response.data;\n        var lens = _this.state.userid;\n        var cache = [], i = 0, siri = [];\n        siri = result.cards;\n        for (; i < lens; i++) {\n          cache = siri.shift();\n          siri.push(cache);\n        }\n\n        _this.setState({\n          holdid: result.hold,\n          cardvalue: siri,\n          cardcur: result.cur,\n        })\n\n\n\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n\n  }\n\n\n\n  initData(n) {\n    let formdata = new FormData();\n    formdata.append(\"init\", n);\n    formdata.append(\"pnum\", players_num);\n    console.log(formdata);\n    const _this = this;\n    axios({\n      method: 'post',\n      url: 'apipk/',\n      data: formdata,\n    })\n      .then(function (response) {\n        var result = response.data;\n        console.log(result)\n        var lens = result.userid;\n        var cache, i = 0;\n        for (; i < lens; i++) {\n          cache = result.players.shift();\n          result.players.push(cache);\n        }\n\n        _this.setState({\n          players: result.players,\n          userid: result.userid,\n          holdid: result.holdid,\n        })\n\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n\n  }\n\n\n  toSuit(formdata) {\n    axios({\n      method: 'post',\n      url: 'apipk/',\n      data: formdata,\n    })\n      .then(function (response) {\n        var result = response.data;\n        console.log(result)\n        // var lens = _this.state.userid;\n        // var cache = [], i = 0, siri = [];\n        // siri = result.cards;\n\n        // for (; i < lens; i++) {\n        //   cache = siri.shift();\n        //   siri.push(cache);\n        // }\n        // _this.setState({\n        //   cardvalue: result.cards,\n        //   cardcur: result.cur,\n        // })\n\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n\n  }\n\n  btn_call() {\n    const s = this.state.isSel.slice();\n    var card = [];\n    var num = [];\n    var i = 0, len = this.state.isSel.length;\n    for (; i < len; i++) {\n      if (s[i]) {\n        num.push(i);\n        card.push(this.state.cardvalue[0][i]);\n      }\n    }\n    if (num.length > 0) {\n      var formdata = new FormData();\n      formdata.append(\"suit\", 1);\n      formdata.append(\"num\", num);\n      formdata.append(\"card\", card);\n      this.toSuit(formdata);\n      const slicy = Array(16).fill(false);\n      this.setState({\n        isSel: slicy,\n      })\n    }\n    else {\n      console.log(\"没有选牌\");\n    }\n  }\n\n  btn_recall() {\n    var formdata = new FormData();\n    formdata.append(\"suit\", 2);\n    this.toSuit(formdata);\n    console.log(\"取回牌\")\n  }\n\n  btn_update() {\n    this.syncData();\n    console.log(\"手动同步数据\")\n  }\n\n  btn_start() {\n    this.initData(4)\n  }\n\n  btn_end() {\n    this.initData(0)\n  }\n  btn_turn() {\n    var formdata = new FormData();\n    formdata.append(\"suit\", 3);\n    this.toSuit(formdata);\n  }\n  btn_next() {\n    var formdata = new FormData();\n    formdata.append(\"suit\", 4);\n    this.toSuit(formdata);\n  }\n\n  btn_card(i) {\n    const slicy = this.state.isSel.slice();\n    slicy[i] = this.state.isSel[i] ? false : true;\n    this.setState({\n      isSel: slicy,\n    });\n  }\n  btn_setnum(i, s) {\n    players_num = s;\n    document.getElementById(\"curmode\").innerHTML = document.getElementById(\"lilist\").children[i].innerHTML;\n  }\n\n  renderYard(c, i) {\n    var cclass = c % 4;\n    var cnum = Math.floor(c / 4);\n    if (c > 51) {\n      cclass = 4;\n      cnum = c - 39;\n    } else {\n      cclass = c % 4;\n      cnum = Math.floor(c / 4);\n    }\n    return <Cardy\n      value={cnum}\n      key={i}\n      className={cardclass[cclass]}\n    />;\n  }\n\n  renderCard(c, i) {\n    var cclass = c % 4;\n    var cnum = Math.floor(c / 4);\n    if (c > 51) {\n      cclass = 4;\n      cnum = c - 39;\n    } else {\n      cclass = c % 4;\n      cnum = Math.floor(c / 4);\n    }\n\n    if (this.state.isSel[i]) {\n      cclass = cclass + 5;\n    }\n    return <Card\n      value={cnum}\n      key={i}\n      className={cardclass[cclass]}\n      onClick={() => this.btn_card(i)}\n\n    />;\n  }\n  renderMantainer() {\n\n    if (this.state.userid === 0) {\n      return (\n        <Fragment>\n          <button onClick={() => this.btn_start()}>新局</button>\n          <div class=\"drop-box\">\n            <p class=\"txt\" id=\"curmode\">四人局</p>\n            <ul class=\"menu\" id=\"lilist\">\n              <li sort=\"0\" onClick={() => this.btn_setnum(0, 4)}>四人局</li>\n              <li sort=\"1\" onClick={() => this.btn_setnum(1, 3)}>三人局</li>\n              <li sort=\"2\" onClick={() => this.btn_setnum(2, 2)}>两人局</li>\n            </ul>\n          </div>\n        </Fragment>\n      )\n    }\n  }\n\n  renderZone(c, i) {\n    if (i < 3) {\n      return (\n        <div class=\"player_ot\">\n          <h3>对家名称：{this.state.players[3 - i]}</h3>\n          <h2>剩余牌数：{this.state.cardvalue[3 - i].length}</h2>\n        </div>\n      )\n    }\n  }\n\n  renderHold() {\n    if (this.state.holdid === this.state.userid) {\n      return (\n        <Fragment>\n          <button onClick={() => this.btn_call()}>出牌</button>\n          <button onClick={() => this.btn_next()}>不出</button>\n        </Fragment >\n      )\n    }\n    else {\n      return (\n        <Fragment>\n          <button onClick={() => this.btn_turn()}>勾叉</button>\n          <button onClick={() => this.btn_turn()}>轮值</button>\n        </Fragment >\n      )\n    }\n  }\n  render() {\n    return (\n      <Fragment>\n        <div id=\"palyers_zone\">\n          {this.state.players.map((c, i) => this.renderZone(c, i))}\n          <button onClick={() => this.btn_update()}>刷新</button>\n          <button onClick={() => this.btn_recall()}>取回</button>\n          {this.renderMantainer()}\n        </div>\n        <div id=\"player_yard\">\n          <div id=\"cur_mani\">\n            <h3>执行操作：</h3>\n            {this.renderHold()}\n          </div>\n          <div id=\"cur_card\">\n            <h2>当前出牌：</h2>\n            {this.state.cardcur.map((c, i) => this.renderYard(c, i))}\n          </div>\n        </div>\n        <div id=\"player_me\">\n          <p>\n            <h2>\n              当前玩家：{this.state.players[0]}，点击下方卡牌，其变蓝后，点击出牌按钮。\n            </h2>\n          </p>\n          {this.state.cardvalue[0].map((c, i) => this.renderCard(c, i, 'Card'))}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\n// ========================================\nReactDOM.render(<Gzone />, document.getElementById('mid'));"],"sourceRoot":""}